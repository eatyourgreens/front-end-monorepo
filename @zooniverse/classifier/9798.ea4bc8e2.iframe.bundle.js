/*! For license information please see 9798.ea4bc8e2.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_zooniverse_classifier=self.webpackChunk_zooniverse_classifier||[]).push([[9798],{"./src/components/Classifier/components/SubjectViewer/components/BarChartViewer/BarChartViewer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>BarChartViewer_BarChartViewer});var prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("../../node_modules/react/index.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),Group=__webpack_require__("../../node_modules/@visx/group/esm/Group.js"),AxisLeft=__webpack_require__("../../node_modules/@visx/axis/esm/axis/AxisLeft.js"),AxisBottom=__webpack_require__("../../node_modules/@visx/axis/esm/axis/AxisBottom.js"),band=__webpack_require__("../../node_modules/@visx/scale/esm/scales/band.js"),linear=__webpack_require__("../../node_modules/@visx/scale/esm/scales/linear.js"),extent=__webpack_require__("../../node_modules/d3-array/src/extent.js"),withParentSize=__webpack_require__("../../node_modules/@visx/responsive/esm/enhancers/withParentSize.js"),i18n=__webpack_require__("./src/translations/i18n.js"),Chart=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/SVGComponents/Chart/index.js"),Background=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/SVGComponents/Background/index.js"),Bar=__webpack_require__("../../node_modules/@visx/shape/esm/shapes/Bar.js"),Tooltip=__webpack_require__("../lib-react-components/dist/esm/Tooltip/Tooltip.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),StyledSvg=styled_components_browser_esm.default.svg.withConfig({displayName:"Bars__StyledSvg",componentId:"sc-kfnx84-0"})(["&:focus,&:hover{rect{outline:solid 4px ",";}}"],(function(props){return props.focusColor})),DEFAULT_THEME={dark:!1,global:{colors:{brand:"",text:{}}}};function Bars(_ref){var data=_ref.data,_ref$xAxisLabel=_ref.xAxisLabel,xAxisLabel=void 0===_ref$xAxisLabel?"x-axis":_ref$xAxisLabel,xScale=_ref.xScale,_ref$yAxisLabel=_ref.yAxisLabel,yAxisLabel=void 0===_ref$yAxisLabel?"y-axis":_ref$yAxisLabel,yScale=_ref.yScale,yMax=_ref.yMax,_ref$theme=_ref.theme,theme=void 0===_ref$theme?DEFAULT_THEME:_ref$theme;return data.map((function(datum,index){var color=datum.color,label=datum.label,value=datum.value,fill=theme.global.colors[color]||color||theme.global.colors.brand,key="bar-".concat(label),barHeight=yMax-yScale(value),barWidth=xScale.bandwidth(),x=xScale(label),y=yMax-barHeight,alt="".concat(xAxisLabel," ").concat(label,": ").concat(yAxisLabel," ").concat(value);return(0,jsx_runtime.jsx)(Tooltip.A,{label:value.toString(),children:(0,jsx_runtime.jsx)(StyledSvg,{"aria-label":alt,tabIndex:"0",focusable:!0,focusColor:theme.global.colors[theme.global.colors.focus],role:"listitem",children:(0,jsx_runtime.jsx)(Bar.A,{"data-label":label,"data-value":value,fill,focusColor:theme.global.colors.focus,height:barHeight,index,width:barWidth,x,y})})},key)}))}Bars.propTypes={data:prop_types_default().array.isRequired,theme:prop_types_default().object,xAxisLabel:prop_types_default().string,xScale:prop_types_default().func.isRequired,yAxisLabel:prop_types_default().string,yScale:prop_types_default().func.isRequired,yMax:prop_types_default().number.isRequired};const Bars_Bars=(0,styled_components_browser_esm.withTheme)(Bars);var StyledGroup=(0,styled_components_browser_esm.default)(Group.A).withConfig({displayName:"BarChartViewer__StyledGroup",componentId:"sc-1vdcr8h-0"})([".Axis__label{text-transform:uppercase;font-weight:bold;letter-spacing:1px;}"]),BarChartViewer=(0,react.forwardRef)((function BarChartViewer(props,ref){var _props$barStyles=props.barStyles,_props$barStyles2$pad=(void 0===_props$barStyles?{padding:.25}:_props$barStyles).padding,padding=void 0===_props$barStyles2$pad?.25:_props$barStyles2$pad,data=props.data,_props$margin=props.margin,_props$margin2=void 0===_props$margin?{bottom:40,left:40,right:10,top:10}:_props$margin,_props$margin2$bottom=_props$margin2.bottom,bottom=void 0===_props$margin2$bottom?40:_props$margin2$bottom,_props$margin2$left=_props$margin2.left,left=void 0===_props$margin2$left?40:_props$margin2$left,_props$margin2$right=_props$margin2.right,right=void 0===_props$margin2$right?10:_props$margin2$right,_props$margin2$top=_props$margin2.top,top=void 0===_props$margin2$top?10:_props$margin2$top,parentHeight=props.parentHeight,parentWidth=props.parentWidth,_props$theme=props.theme,_props$theme2=void 0===_props$theme?{dark:!1,global:{colors:{brand:"",text:{}},font:{family:""}}}:_props$theme,_props$theme2$dark=_props$theme2.dark,dark=void 0!==_props$theme2$dark&&_props$theme2$dark,_props$theme2$global=_props$theme2.global,_props$theme2$global2=void 0===_props$theme2$global?{colors:{brand:"",text:{}},font:{family:""}}:_props$theme2$global,_props$theme2$global3=_props$theme2$global2.colors,colors=void 0===_props$theme2$global3?{}:_props$theme2$global3,_props$theme2$global4=_props$theme2$global2.font,font=void 0===_props$theme2$global4?{family:""}:_props$theme2$global4,_props$xAxisLabel=props.xAxisLabel,xAxisLabel=void 0===_props$xAxisLabel?"x-axis":_props$xAxisLabel,yAxisDomain=props.yAxisDomain,_props$yAxisLabel=props.yAxisLabel,yAxisLabel=void 0===_props$yAxisLabel?"y-axis":_props$yAxisLabel,t=(0,i18n.Bd)("components").t,backgroundColor=dark?colors["dark-3"]:"white",xMax=parentWidth-left-right,yMax=parentHeight-bottom-top,xScale=(0,band.A)({domain:data.map((function(datum){return datum.label})),range:[0,xMax],round:!0,padding}),yDataExtent=(0,extent.A)(data.map((function(datum){return datum.value}))),yDomain=yAxisDomain||yDataExtent,yScale=(0,linear.A)({domain:yDomain,range:[yMax,0],round:!0}).nice(),xScaleTicks=xScale.domain(),yScaleTicks=yScale.domain(),axisColor=dark?colors.text.dark:colors.text.light;return(0,jsx_runtime.jsxs)(Chart.A,{height:parentHeight+top,ref,width:parentWidth,children:[(0,jsx_runtime.jsx)(Background.A,{fill:backgroundColor}),(0,jsx_runtime.jsx)(Group.A,{"aria-label":t("SubjectViewer.BarChartViewer.chartLabel"),focusable:!0,left,role:"list",tabIndex:"0",top,children:(0,jsx_runtime.jsx)(Bars_Bars,{data,xAxisLabel,xScale,yAxisLabel,yScale,yMax})}),(0,jsx_runtime.jsxs)(StyledGroup,{left,top,children:[(0,jsx_runtime.jsx)(AxisLeft.A,{label:yAxisLabel,labelClassName:"Axis__label",labelProps:{fill:axisColor,textAnchor:"middle",fontSize:12,fontFamily:font.family},left:0,role:"presentation",scale:yScale,stroke:axisColor,ticks:yScaleTicks.length,tickStroke:axisColor,tickLabelProps:function tickLabelProps(value,index){return{fill:axisColor,textAnchor:"end",fontSize:10,fontFamily:font.family,dx:"-0.25em",dy:"0.25em"}},top:0}),(0,jsx_runtime.jsx)(AxisBottom.A,{label:xAxisLabel,labelClassName:"Axis__label",labelProps:{fill:axisColor,textAnchor:"middle",fontSize:12,fontFamily:font.family},left:0,role:"presentation",scale:xScale,stroke:axisColor,ticks:xScaleTicks.length,tickStroke:axisColor,tickLabelProps:function tickLabelProps(value,index){return{fill:axisColor,textAnchor:"middle",fontSize:10,fontFamily:font.family}},top:yMax})]})]})}));BarChartViewer.propTypes={barStyles:prop_types_default().shape({padding:prop_types_default().number}),data:prop_types_default().arrayOf(prop_types_default().shape({color:prop_types_default().string,label:prop_types_default().string.isRequired,value:prop_types_default().number.isRequired})).isRequired,margin:prop_types_default().shape({bottom:prop_types_default().number,left:prop_types_default().number,right:prop_types_default().number,top:prop_types_default().number}),parentHeight:prop_types_default().number.isRequired,parentWidth:prop_types_default().number.isRequired,theme:prop_types_default().object,xAxisLabel:prop_types_default().string,yAxisLabel:prop_types_default().string};const BarChartViewer_BarChartViewer=(0,styled_components_browser_esm.withTheme)((0,withParentSize.A)(BarChartViewer));BarChartViewer.__docgenInfo={description:"",methods:[],displayName:"BarChartViewer",props:{barStyles:{description:"",type:{name:"shape",value:{padding:{name:"number",required:!1}}},required:!1},data:{description:"",type:{name:"arrayOf",value:{name:"shape",value:{color:{name:"string",required:!1},label:{name:"string",required:!0},value:{name:"number",required:!0}}}},required:!0},margin:{description:"",type:{name:"shape",value:{bottom:{name:"number",required:!1},left:{name:"number",required:!1},right:{name:"number",required:!1},top:{name:"number",required:!1}}},required:!1},parentHeight:{description:"",type:{name:"number"},required:!0},parentWidth:{description:"",type:{name:"number"},required:!0},theme:{description:"",type:{name:"object"},required:!1},xAxisLabel:{description:"",type:{name:"string"},required:!1},yAxisLabel:{description:"",type:{name:"string"},required:!1}}}},"./src/components/Classifier/components/SubjectViewer/components/BarChartViewer/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>_BarChartViewer__WEBPACK_IMPORTED_MODULE_0__.Ay});var _BarChartViewer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/BarChartViewer/BarChartViewer.js")},"./src/components/Classifier/components/SubjectViewer/components/JSONDataViewer/JSONDataViewer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>JSONDataViewer_JSONDataViewer});var Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),mobxreact_esm=__webpack_require__("../../node_modules/mobx-react/dist/mobxreact.esm.js"),hooks=__webpack_require__("./src/hooks/index.js"),BarChartViewer=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/BarChartViewer/index.js"),extent=(__webpack_require__("../lib-async-states/src/async-states.js"),__webpack_require__("../../node_modules/d3-array/src/extent.js")),zip=__webpack_require__("../../node_modules/lodash/zip.js"),zip_default=__webpack_require__.n(zip),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("../../node_modules/react/index.js"),LightCurveViewer=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/LightCurveViewer/LightCurveViewer.js"),locationValidator=__webpack_require__("./src/components/Classifier/components/SubjectViewer/helpers/locationValidator/index.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function storeMapper(classifierStore){var annotation,_classifierStore$subj=classifierStore.subjectViewer,enableAnnotate=_classifierStore$subj.enableAnnotate,enableMove=_classifierStore$subj.enableMove,interactionMode=_classifierStore$subj.interactionMode,setOnPan=_classifierStore$subj.setOnPan,setOnZoom=_classifierStore$subj.setOnZoom,addAnnotation=classifierStore.classifications.addAnnotation,activeStepTasks=classifierStore.workflowSteps.activeStepTasks,subject=classifierStore.subjects.active,activeDataVisTask=_slicedToArray(activeStepTasks.filter((function(task){return"dataVisAnnotation"===(null==task?void 0:task.type)})),1)[0],activeToolIndex=(activeDataVisTask||{}).activeToolIndex,latest=null==subject?void 0:subject.stepHistory.latest;if(latest){var _latest$annotations$f=latest.annotations.filter((function(annotation){return activeDataVisTask&&annotation.task===activeDataVisTask.taskKey}));annotation=_slicedToArray(_latest$annotations$f,1)[0]}return{activeDataVisTask,activeToolIndex,addAnnotation,annotation,enableAnnotate,enableMove,interactionMode,setOnPan,setOnZoom}}function LightCurveViewerContainer(_ref2){var _ref2$data=_ref2.data,data=void 0===_ref2$data?null:_ref2$data,_ref2$feedback=_ref2.feedback,feedback=void 0!==_ref2$feedback&&_ref2$feedback,_ref2$feedbackBrushes=_ref2.feedbackBrushes,feedbackBrushes=void 0===_ref2$feedbackBrushes?[]:_ref2$feedbackBrushes,_useStores=(0,hooks.gy)(storeMapper),activeDataVisTask=_useStores.activeDataVisTask,activeToolIndex=_useStores.activeToolIndex,addAnnotation=_useStores.addAnnotation,annotation=_useStores.annotation,enableAnnotate=_useStores.enableAnnotate,enableMove=_useStores.enableMove,interactionMode=_useStores.interactionMode,setOnPan=_useStores.setOnPan,setOnZoom=_useStores.setOnZoom,onKeyZoom=(0,hooks.KG)().onKeyZoom,_useMemo=(0,react.useMemo)((function(){var dataExtent={x:[],y:[]},dataPoints=[];return null!=data&&data.x&&null!=data&&data.y&&(dataExtent={x:(0,extent.A)(data.x),y:(0,extent.A)(data.y)},dataPoints=zip_default()(data.x,data.y)),{dataExtent,dataPoints}}),[data]),dataExtent=_useMemo.dataExtent,dataPoints=_useMemo.dataPoints;return data?(0,jsx_runtime.jsx)(Box.a,{width:"100%",height:"500px",children:(0,jsx_runtime.jsx)(LightCurveViewer.A,{addAnnotation,annotation,currentTask:activeDataVisTask,dataExtent,dataPoints,enableAnnotate,enableMove,feedback,feedbackBrushes,interactionMode,onKeyDown:onKeyZoom,setOnPan,setOnZoom,toolIndex:activeToolIndex})}):null}LightCurveViewerContainer.displayName="LightCurveViewerContainer",LightCurveViewerContainer.propTypes={feedback:prop_types_default().bool,subject:prop_types_default().shape({id:prop_types_default().string,locations:prop_types_default().arrayOf(locationValidator.A)}),loadingState:prop_types_default().string,onError:prop_types_default().func,onReady:prop_types_default().func};const LightCurveViewer_LightCurveViewerContainer=(0,mobxreact_esm.PA)(LightCurveViewerContainer);LightCurveViewerContainer.__docgenInfo={description:"",methods:[],displayName:"LightCurveViewerContainer",props:{data:{defaultValue:{value:"null",computed:!1},required:!1},feedback:{defaultValue:{value:"false",computed:!1},description:"",type:{name:"bool"},required:!1},feedbackBrushes:{defaultValue:{value:"[]",computed:!1},required:!1},subject:{description:"",type:{name:"shape",value:{id:{name:"string",required:!1},locations:{name:"arrayOf",value:{name:"custom",raw:"locationValidator"},required:!1}}},required:!1},loadingState:{description:"",type:{name:"string"},required:!1},onError:{description:"",type:{name:"func"},required:!1},onReady:{description:"",type:{name:"func"},required:!1}}};var ScatterPlotViewer=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/ScatterPlotViewer/index.js"),VariableStarViewer=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/VariableStarViewer/index.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var _excluded=["onError","onReady"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var viewers={BarChart:BarChartViewer.A,DataSeriesPlot:ScatterPlotViewer.A,TESSLightCurve:LightCurveViewer_LightCurveViewerContainer,VariableStarPlots:VariableStarViewer.A};function JSONDataViewer_storeMapper(classifierStore){var subject=classifierStore.subjects.active,_classifierStore$subj=classifierStore.subjectViewer;return{interactionMode:_classifierStore$subj.interactionMode,setOnZoom:_classifierStore$subj.setOnZoom,setOnPan:_classifierStore$subj.setOnPan,subject}}var DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0};function JSONDataViewer(_ref){var _subject$viewerConfig,_ref$onError=_ref.onError,onError=void 0===_ref$onError?DEFAULT_HANDLER:_ref$onError,_ref$onReady=_ref.onReady,onReady=void 0===_ref$onReady?DEFAULT_HANDLER:_ref$onReady,props=function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(-1!==e.indexOf(n))continue;t[n]=r[n]}return t}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}(_ref,_excluded),_useStores=(0,hooks.gy)(JSONDataViewer_storeMapper),interactionMode=_useStores.interactionMode,subject=_useStores.subject,setOnPan=_useStores.setOnPan,setOnZoom=_useStores.setOnZoom,_useSubjectJSON=(0,hooks.ej)({onError,onReady,subject}),jsonData=_useSubjectJSON.data,loading=_useSubjectJSON.loading,error=_useSubjectJSON.error,type=_useSubjectJSON.type,viewer=_useSubjectJSON.viewer;if(loading)return null;if(error)return(0,jsx_runtime.jsx)("p",{children:error.message});var Viewer=viewers[type.name],_ref2="TESSLightCurve"===type.name?{data:jsonData}:jsonData,chartOptions=_ref2.chartOptions,data=_ref2.data,zoomConfiguration=(null==chartOptions?void 0:chartOptions.zoomConfiguration)||(null==subject||null===(_subject$viewerConfig=subject.viewerConfiguration)||void 0===_subject$viewerConfig?void 0:_subject$viewerConfig.zoomConfiguration),chartProps=_objectSpread(_objectSpread({},chartOptions),{},{zoomConfiguration}),height="DataSeriesPlot"===type.name?"500px":void 0;return(0,jsx_runtime.jsx)(Box.a,{ref:viewer,className:type.name,height,width:"100%",children:(0,jsx_runtime.jsx)(Viewer,_objectSpread(_objectSpread({data,experimentalSelectionTool:!0,interactionMode,setOnPan,setOnZoom,subject,zoomConfiguration,zooming:!0},chartProps),props))})}JSONDataViewer.displayName="JSONDataViewer";const JSONDataViewer_JSONDataViewer=(0,mobxreact_esm.PA)(JSONDataViewer);JSONDataViewer.__docgenInfo={description:"",methods:[],displayName:"JSONDataViewer",props:{onError:{defaultValue:{value:"() => true",computed:!1},required:!1},onReady:{defaultValue:{value:"() => true",computed:!1},required:!1}}}},"./src/components/Classifier/components/SubjectViewer/components/LightCurveViewer/LightCurveViewer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>LightCurveViewer_LightCurveViewer});var d3=__webpack_require__("../../node_modules/d3/index.js"),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("../../node_modules/react/index.js"),Chart=(__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/SVGComponents/Background/index.js"),__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/SVGComponents/Chart/index.js"));__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/SVGComponents/SVGImage/index.js"),__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/SVGComponents/VisXZoom/index.js"),__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/SVGComponents/ZoomEventLayer/index.js");function addAxisLabel(selection,className,text,axisStyle){return selection.append("text").attr("class",className).style("font-size",axisStyle.fontSize).style("font-family",axisStyle.fontFamily).style("fill",axisStyle.color).text(text)}function cancelEvent(event){event.stopPropagation}function addRemoveAnnotationButton(selection){var onClick=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,g=selection.append("g").attr("class","remove-button").attr("transform","translate(0, 0)").style("cursor","pointer");return g.append("circle").attr("fill","#4cc").attr("r",10).attr("cx",0).attr("cy",10).style("pointer-events","all").on("mousedown touchstart",cancelEvent).on("click",onClick),g.append("path").attr("stroke","#eee").attr("stroke-width","3").attr("d","M ".concat(-4," ").concat(6," L ").concat(4," ").concat(14," M ").concat(4," ").concat(6," L ").concat(-4," ").concat(14," ")).style("pointer-events","none"),g}function addBackgroundLayer(selection,chartStyle){return selection.append("rect").attr("class","deco background-layer").attr("width","100%").attr("height","100%").attr("fill",chartStyle.background)}function addBorderLayer(selection){return selection.append("rect").attr("class","deco border-layer").attr("width","100%").attr("height","100%").attr("fill","none").attr("stroke","#444").attr("stroke-width","2")}function addDataLayer(selection){var id=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return selection.append("g").attr("class","data-layer").attr("clip-path","url(#data-mask-".concat(id,")"))}function addDataMask(selection,outerMargin){var id=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return selection.append("clipPath").attr("id","data-mask-".concat(id)).append("rect").attr("class","data-mask").attr("transform","translate(".concat(outerMargin,", ").concat(outerMargin,")")).attr("width",0).attr("height",0)}function addInterfaceLayer(selection){return selection.append("rect").attr("class","interface-layer").attr("width","100%").attr("height","100%").style("fill","none").style("pointer-events","all").style("cursor","move")}function setDataPointStyle(selection,chartStyle){return selection.attr("class","data-point").attr("r",chartStyle.dataPointSize).attr("fill",chartStyle.color)}var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}function _callSuper(t,o,e){return o=_getPrototypeOf(o),function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(t,_isNativeReflectConstruct()?Reflect.construct(o,e||[],_getPrototypeOf(t).constructor):o.apply(t,e))}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}var LightCurveViewer_d3={axisRight:d3.eH3,axisTop:d3.tlR,brushX:d3.n55,scaleLinear:d3.m4Y,select:d3.Ltv,zoom:d3.s_O,zoomIdentity:d3.GSI,zoomTransform:d3._V},DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!0};function drawFeedbackBrushes(d3annotationsLayer,repositionBrush,feedbackBrushes){feedbackBrushes.forEach((function(feedbackBrush){feedbackBrush.brush=(0,d3.n55)()})),d3annotationsLayer.selectAll(".brush").data(feedbackBrushes,(function(d){return d.id})).enter().insert("g",".brush").attr("class","brush").attr("id",(function(brush){return"brush-".concat(brush.id)})).each((function applyBrushLogic(feedbackBrush){feedbackBrush.brush((0,d3.Ltv)(this))})),feedbackBrushes.forEach((function(feedbackBrush){var d3brush=d3annotationsLayer.select("#brush-".concat(feedbackBrush.id));d3brush.attr("class","brush").selectAll(".selection").style("fill",(function(){return!0===feedbackBrush.success?"green":!1===feedbackBrush.success?"red":"white"})),repositionBrush(feedbackBrush,d3brush)}))}var LightCurveViewer=function(_Component){function LightCurveViewer(props){var _this;!function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,LightCurveViewer);var defaultProps={forwardRef:(0,react.createRef)(),dataExtent:{x:[-1,1],y:[-1,1]},dataPoints:[[]],minZoom:1,maxZoom:10,innerMargin:30,outerMargin:10,axisXLabel:"Days",axisXOffsetX:-40,axisXOffsetY:-20,axisYLabel:"Brightness",axisYOffsetX:20,axisYOffsetY:20,chartStyle:{color:"#eff2f5",background:"#003941",dataPointSize:"1.5",fontFamily:"inherit",fontSize:"0.75rem"},interactionMode:"annotate",onKeyDown:DEFAULT_HANDLER};return(_this=_callSuper(this,LightCurveViewer,[_objectSpread(_objectSpread({},defaultProps),props)])).mergedProps=_objectSpread(_objectSpread({},defaultProps),props),_this.svgContainer=_this.mergedProps.forwardRef,_this.d3annotationsLayer=null,_this.d3dataMask=null,_this.d3dataLayer=null,_this.d3interfaceLayer=null,_this.d3svg=null,_this.zoom=null,_this.xScale=null,_this.yScale=null,_this.xAxis=null,_this.yAxis=null,_this.annotationBrushes=[],_this.doZoom=_this.doZoom.bind(_this),_this.drawChart=_this.drawChart.bind(_this),_this.removeAnnotationBrush=_this.removeAnnotationBrush.bind(_this),_this.onAnnotationBrushStart=_this.onAnnotationBrushStart.bind(_this),_this.onAnnotationBrushBrushed=_this.onAnnotationBrushBrushed.bind(_this),_this.onAnnotationBrushEnd=_this.onAnnotationBrushEnd.bind(_this),_this.handleToolbarZoom=_this.handleToolbarZoom.bind(_this),_this.repositionBrush=_this.repositionBrush.bind(_this),_this.pan=_this.pan.bind(_this),_this.zoomIn=_this.zoomIn.bind(_this),_this.zoomOut=_this.zoomOut.bind(_this),_this.zoomTo=_this.zoomTo.bind(_this),_this}return function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}(LightCurveViewer,_Component),function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(LightCurveViewer,[{key:"componentDidMount",value:function componentDidMount(){this.initChart(),this.mergedProps.setOnZoom(this.handleToolbarZoom),this.mergedProps.setOnPan(this.pan),this.drawChart()}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var dataChanged=this.mergedProps.dataPoints!==prevProps.dataPoints;this.mergedProps.currentTask&&this.mergedProps.currentTask.taskKey,prevProps.currentTask&&prevProps.currentTask.taskKey;dataChanged&&(this.clearChart(),this.drawChart(!1)),prevProps.interactionMode!==this.mergedProps.interactionMode&&this.updateInteractionMode(this.mergedProps.interactionMode)}},{key:"componentWillUnmount",value:function componentWillUnmount(){var _this$svgContainer$cu;this.zoom&&this.zoom.on("zoom",null),this.d3svg&&this.d3svg.on("zoom",null),null===(_this$svgContainer$cu=this.svgContainer.current)||void 0===_this$svgContainer$cu||_this$svgContainer$cu.replaceChildren()}},{key:"clearChart",value:function clearChart(){this.d3dataLayer.selectAll(".data-point").remove(),this.resetBrushes(),this.zoomTo(1)}},{key:"drawChart",value:function drawChart(){var shouldAnimate=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],_this$mergedProps=this.mergedProps,chartStyle=_this$mergedProps.chartStyle,dataExtent=_this$mergedProps.dataExtent,dataPoints=_this$mergedProps.dataPoints,feedbackBrushes=_this$mergedProps.feedbackBrushes,innerMargin=_this$mergedProps.innerMargin,outerMargin=_this$mergedProps.outerMargin,container=this.svgContainer.current,_container$getBoundin=null==container?void 0:container.getBoundingClientRect(),height=_container$getBoundin.height,width=_container$getBoundin.width;if(height&&width){this.zoom.translateExtent([[-outerMargin,0],[width+outerMargin,0]]),this.xScale.domain(dataExtent.x).range([0+innerMargin,width-innerMargin]),this.yScale.domain(this.mergedProps.dataExtent.y).range([height-innerMargin,0+innerMargin]),this.updatePresentation(width,height);var points=this.d3dataLayer.selectAll(".data-point").data(dataPoints);points.enter().append("circle").call(setDataPointStyle,chartStyle),points.exit().remove(),this.updateDataPoints(shouldAnimate),this.updatePresentation(width,height),this.mergedProps.feedback?(this.updateInteractionMode("move"),this.disableBrushEvents(),drawFeedbackBrushes(this.d3annotationsLayer,this.repositionBrush,feedbackBrushes)):(this.updateAnnotationBrushes(),this.initBrushes())}}},{key:"initBrushes",value:function initBrushes(){this.annotationBrushes.length||(this.loadBrushesFromAnnotations(),this.createAnnotationBrush(),this.updateAnnotationBrushes())}},{key:"resetBrushes",value:function resetBrushes(){this.annotationBrushes=[],this.d3annotationsLayer.selectAll(".brush").remove()}},{key:"loadBrushesFromAnnotations",value:function loadBrushesFromAnnotations(){var _this2=this,annotationValues=this.getAnnotationValues();null==annotationValues||annotationValues.forEach((function(data){var brush=_this2.createAnnotationBrush();brush.minX=data.x-data.width/2,brush.maxX=data.x+data.width/2,brush.zoomLevelOnCreation=data.zoomLevelOnCreation}))}},{key:"saveBrushesToAnnotations",value:function saveBrushesToAnnotations(){var _this$mergedProps2=this.mergedProps,addAnnotation=_this$mergedProps2.addAnnotation,currentTask=_this$mergedProps2.currentTask,toolIndex=_this$mergedProps2.toolIndex;if(this.isCurrentTaskValidForAnnotation()){var annotations=this.annotationBrushes.filter((function(raw){return void 0!==raw.minX&&void 0!==raw.maxX&&null!==raw.minX&&null!==raw.maxX})).map((function(raw){var x=(raw.minX+raw.maxX)/2,width=Math.abs(raw.maxX-raw.minX),toolType=currentTask.tools[toolIndex].type;return{x,width,tool:toolIndex,zoomLevelOnCreation:raw.zoomLevelOnCreation,toolType}}));null==addAnnotation||addAnnotation(currentTask,annotations)}}},{key:"createAnnotationBrush",value:function createAnnotationBrush(){var defaultBrush=this.getDefaultBrush(),newAnnotationBrush={id:defaultBrush&&defaultBrush.id+1||0,brush:LightCurveViewer_d3.brushX().on("start",this.onAnnotationBrushStart).on("brush",this.onAnnotationBrushBrushed).on("end",this.onAnnotationBrushEnd),minX:void 0,maxX:void 0,zoomLevelOnCreation:void 0};return this.annotationBrushes.push(newAnnotationBrush),newAnnotationBrush}},{key:"removeAnnotationBrush",value:function removeAnnotationBrush(event,annotationBrush){this.annotationBrushes=this.annotationBrushes.filter((function(ab){return ab.id!==annotationBrush.id})),this.updateAnnotationBrushes(),this.saveBrushesToAnnotations()}},{key:"disableBrushEvents",value:function disableBrushEvents(){this.annotationBrushes.forEach((function(annotationBrush){annotationBrush.brush.on("start",null).on("brush",null).on("end",null)}))}},{key:"enableBrushEvents",value:function enableBrushEvents(){var _this3=this;this.annotationBrushes.forEach((function(annotationBrush){annotationBrush.brush.on("start",_this3.onAnnotationBrushStart).on("brush",_this3.onAnnotationBrushBrushed).on("end",_this3.onAnnotationBrushEnd)}))}},{key:"getDefaultBrush",value:function getDefaultBrush(){return this.annotationBrushes.length&&this.annotationBrushes[this.annotationBrushes.length-1]}},{key:"onAnnotationBrushStart",value:function onAnnotationBrushStart(){}},{key:"onAnnotationBrushBrushed",value:function onAnnotationBrushBrushed(){}},{key:"onAnnotationBrushEnd",value:function onAnnotationBrushEnd(_ref,annotationBrush){var selection=_ref.selection,enableMove=this.mergedProps.enableMove,brushSelection=selection;if(!this.isCurrentTaskValidForAnnotation())return this.disableBrushEvents(),this.d3annotationsLayer.select(".brush").call(annotationBrush.brush.move,null),this.enableBrushEvents(),void(null==enableMove||enableMove());var currentTransform=this.getCurrentTransform(),dataMinX=brushSelection&&brushSelection[0],dataMaxX=brushSelection&&brushSelection[1];annotationBrush.minX=dataMinX&&currentTransform.rescaleX(this.xScale).invert(dataMinX),annotationBrush.maxX=dataMaxX&&currentTransform.rescaleX(this.xScale).invert(dataMaxX),void 0===annotationBrush.zoomLevelOnCreation&&(annotationBrush.zoomLevelOnCreation=this.getCurrentTransform().k),this.getDefaultBrush()===annotationBrush&&brushSelection&&this.createAnnotationBrush(),this.updateAnnotationBrushes(),this.saveBrushesToAnnotations()}},{key:"getAnnotationValues",value:function getAnnotationValues(){var annotation=this.mergedProps.annotation;return annotation&&this.isCurrentTaskValidForAnnotation()&&Array.from(annotation.value)||[]}},{key:"getCurrentTransform",value:function getCurrentTransform(){return this.d3interfaceLayer&&LightCurveViewer_d3.zoomTransform(this.d3interfaceLayer.node())||LightCurveViewer_d3.zoomIdentity}},{key:"handleToolbarZoom",value:function handleToolbarZoom(type,zoomValue){var doZoom={zoomin:this.zoomIn,zoomout:this.zoomOut,zoomto:this.zoomTo};doZoom[type]&&doZoom[type](zoomValue)}},{key:"doZoom",value:function doZoom(){this.updateDataPoints(),this.updatePresentation(),this.mergedProps.feedback?(this.updateInteractionMode("move"),this.disableBrushEvents(),drawFeedbackBrushes(this.d3annotationsLayer,this.repositionBrush,this.mergedProps.feedbackBrushes)):this.updateAnnotationBrushes()}},{key:"zoomIn",value:function zoomIn(){this.zoom.scaleBy(this.d3interfaceLayer.transition().duration(100),1.2)}},{key:"zoomOut",value:function zoomOut(){this.zoom.scaleBy(this.d3interfaceLayer.transition().duration(100),.8)}},{key:"zoomTo",value:function zoomTo(zoomValue){this.zoom.scaleTo(this.d3interfaceLayer.transition().duration(100),zoomValue)}},{key:"pan",value:function pan(xMultiplier){this.zoom.translateBy(this.d3interfaceLayer.transition().duration(100),20*-xMultiplier,0)}},{key:"initChart",value:function initChart(){var _this$mergedProps3=this.mergedProps,axisXLabel=_this$mergedProps3.axisXLabel,axisYLabel=_this$mergedProps3.axisYLabel,chartStyle=_this$mergedProps3.chartStyle,id=_this$mergedProps3.id,interactionMode=_this$mergedProps3.interactionMode,minZoom=_this$mergedProps3.minZoom,maxZoom=_this$mergedProps3.maxZoom,outerMargin=_this$mergedProps3.outerMargin,container=this.svgContainer.current;this.d3svg=LightCurveViewer_d3.select(container).style("cursor","crosshair"),this.xScale=LightCurveViewer_d3.scaleLinear(),this.yScale=LightCurveViewer_d3.scaleLinear(),this.d3svg.call(addBackgroundLayer,chartStyle);var uniqueId=id||Math.floor(1e6*Math.random());this.d3svg.call(addDataLayer,uniqueId),this.d3dataLayer=this.d3svg.select(".data-layer"),this.d3svg.call(addDataMask,outerMargin,uniqueId),this.d3dataMask=this.d3svg.select(".data-mask"),this.xAxis=LightCurveViewer_d3.axisTop(this.yScale),this.yAxis=LightCurveViewer_d3.axisRight(this.yScale),function addAxis(selection,chartStyle,xAxis,yAxis,axisXLabel,axisYLabel){var axisLayer=selection.append("g").attr("class","axis-layer");return axisLayer.append("g").attr("class","x-axis").attr("color",chartStyle.color).call(xAxis),axisLayer.append("g").attr("class","y-axis").attr("color",chartStyle.color).call(yAxis),axisLayer.call(addAxisLabel,"x-axis-label",axisXLabel,chartStyle),axisLayer.call(addAxisLabel,"y-axis-label",axisYLabel,chartStyle),axisLayer}(this.d3svg,chartStyle,this.xAxis,this.yAxis,axisXLabel,axisYLabel),this.d3svg.call(addBorderLayer),this.zoom=LightCurveViewer_d3.zoom().scaleExtent([minZoom,maxZoom]).on("zoom",this.doZoom),this.d3svg.append("g").attr("class","annotations-layer"),this.d3annotationsLayer=this.d3svg.select(".annotations-layer"),this.d3svg.call(addInterfaceLayer),this.d3interfaceLayer=this.d3svg.select(".interface-layer"),this.d3interfaceLayer.call(this.zoom),this.updateInteractionMode(interactionMode)}},{key:"updateInteractionMode",value:function updateInteractionMode(){var interactionMode=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.zoom&&this.d3interfaceLayer&&("annotate"===interactionMode?this.d3interfaceLayer.style("display","none"):"move"===interactionMode&&this.d3interfaceLayer.style("display","inline"))}},{key:"isCurrentTaskValidForAnnotation",value:function isCurrentTaskValidForAnnotation(){return"dataVisAnnotation"===this.mergedProps.currentTask.type&&this.mergedProps.currentTask.tools.some((function(tool){return"graph2dRangeX"===tool.type}))}},{key:"updateAnnotationBrushes",value:function updateAnnotationBrushes(){var _this4=this,annotationBrushes=(this.mergedProps.feedbackBrushes,this.annotationBrushes),defaultBrush=this.getDefaultBrush(),brushSelection=this.d3annotationsLayer.selectAll(".brush").data(annotationBrushes,(function(d){return d.id}));brushSelection.enter().insert("g",".brush").attr("class","brush").attr("id",(function(brush){return"brush-".concat(brush.id)})).each((function applyBrushLogic(annotationBrush){annotationBrush.brush(LightCurveViewer_d3.select(this))})).call(addRemoveAnnotationButton,this.removeAnnotationBrush),brushSelection.each((function disableInvisibleBrushOverlay(annotationBrush){LightCurveViewer_d3.select(this).attr("class","brush").selectAll(".overlay").style("pointer-events",(function(){var brush=annotationBrush.brush;return annotationBrush.id===defaultBrush.id&&void 0!==brush?"all":"none"}))})),brushSelection.exit().remove(),this.disableBrushEvents(),this.annotationBrushes.forEach((function(annotationBrush){var d3brush=_this4.d3annotationsLayer.select("#brush-".concat(annotationBrush.id));annotationBrush.minX&&annotationBrush.maxX?_this4.repositionBrush(annotationBrush,d3brush):d3brush.select(".remove-button").attr("visibility","hidden")})),this.enableBrushEvents()}},{key:"repositionBrush",value:function repositionBrush(brush,d3brush){var currentTransform=this.getCurrentTransform(),minXonScreen=currentTransform.rescaleX(this.xScale)(brush.minX),maxXonScreen=currentTransform.rescaleX(this.xScale)(brush.maxX),midXonScreen=currentTransform.rescaleX(this.xScale)((brush.minX+brush.maxX)/2);d3brush.call(brush.brush.move,[minXonScreen,maxXonScreen]),d3brush.select(".remove-button").attr("visibility","visible").attr("transform","translate(".concat(midXonScreen,", 0)"))}},{key:"updateDataPoints",value:function updateDataPoints(){var _this5=this,shouldAnimate=arguments.length>0&&void 0!==arguments[0]&&arguments[0],currentTransform=this.getCurrentTransform(),dataPoints=this.d3dataLayer.selectAll(".data-point");shouldAnimate?dataPoints.transition().attr("cx",(function(d){return currentTransform.rescaleX(_this5.xScale)(d[0])})).attr("cy",(function(d){return _this5.yScale(d[1])})):dataPoints.attr("cx",(function(d){return currentTransform.rescaleX(_this5.xScale)(d[0])})).attr("cy",(function(d){return _this5.yScale(d[1])}))}},{key:"updatePresentation",value:function updatePresentation(width,height){var _this$mergedProps4=this.mergedProps,chartStyle=_this$mergedProps4.chartStyle,outerMargin=_this$mergedProps4.outerMargin,currentTransform=this.getCurrentTransform();this.updateScales(currentTransform),width&&height&&(this.repositionAxes(width,height),this.repositionAxisLabels(width,height,chartStyle),this.resizeDataMask(width,height,outerMargin))}},{key:"updateScales",value:function updateScales(transform){this.xAxis.scale(transform.rescaleX(this.xScale)),this.d3svg.select(".x-axis").call(this.xAxis),this.yAxis.scale(this.yScale),this.d3svg.select(".y-axis").call(this.yAxis)}},{key:"repositionAxes",value:function repositionAxes(width,height){this.d3svg.select(".x-axis").attr("transform","translate(0, ".concat(height,")")),this.d3svg.select(".y-axis").attr("transform","translate(0, 0)")}},{key:"repositionAxisLabels",value:function repositionAxisLabels(width,height,chartStyle){var _this$mergedProps5=this.mergedProps,axisXOffsetX=_this$mergedProps5.axisXOffsetX,axisXOffsetY=_this$mergedProps5.axisXOffsetY,axisYOffsetX=_this$mergedProps5.axisYOffsetX,axisYOffsetY=_this$mergedProps5.axisYOffsetY;this.d3svg.select(".x-axis-label").attr("transform","translate(".concat(width+axisXOffsetX,", ").concat(height+axisXOffsetY,")")),this.d3svg.select(".y-axis-label").attr("transform","translate(".concat(axisYOffsetX,", ").concat(axisYOffsetY,")"))}},{key:"resizeDataMask",value:function resizeDataMask(width,height,margin){this.d3dataMask.attr("width",width-2*margin).attr("height",height-2*margin)}},{key:"render",value:function render(){return(0,jsx_runtime.jsx)(Chart.A,{className:"light-curve-viewer",focusable:!0,onKeyDown:this.mergedProps.onKeyDown,tabIndex:0,ref:this.svgContainer,style:{touchAction:"pinch-zoom"}})}}])}(react.Component);LightCurveViewer.displayName="LightCurveViewer",LightCurveViewer.propTypes={dataExtent:prop_types_default().shape({x:prop_types_default().arrayOf(prop_types_default().number),y:prop_types_default().arrayOf(prop_types_default().number)}),dataPoints:prop_types_default().arrayOf(prop_types_default().arrayOf(prop_types_default().number)),minZoom:prop_types_default().number,maxZoom:prop_types_default().number,innerMargin:prop_types_default().number,outerMargin:prop_types_default().number,axisXLabel:prop_types_default().string,axisXOffsetX:prop_types_default().number,axisXOffsetY:prop_types_default().number,axisYLabel:prop_types_default().string,axisYOffsetX:prop_types_default().number,axisYOffsetY:prop_types_default().number,chartStyle:prop_types_default().shape({color:prop_types_default().string,background:prop_types_default().string,dataPointSize:prop_types_default().string,fontFamily:prop_types_default().string,fontSize:prop_types_default().string}),id:prop_types_default().number,interactionMode:prop_types_default().oneOf(["annotate","move"]),setOnZoom:prop_types_default().func.isRequired,onKeyDown:prop_types_default().func};const LightCurveViewer_LightCurveViewer=LightCurveViewer;LightCurveViewer.__docgenInfo={description:"",methods:[{name:"clearChart",docblock:null,modifiers:[],params:[],returns:null},{name:"drawChart",docblock:null,modifiers:[],params:[{name:"shouldAnimate",optional:!0,type:null}],returns:null},{name:"initBrushes",docblock:null,modifiers:[],params:[],returns:null},{name:"resetBrushes",docblock:null,modifiers:[],params:[],returns:null},{name:"loadBrushesFromAnnotations",docblock:null,modifiers:[],params:[],returns:null},{name:"saveBrushesToAnnotations",docblock:null,modifiers:[],params:[],returns:null},{name:"createAnnotationBrush",docblock:null,modifiers:[],params:[],returns:null},{name:"removeAnnotationBrush",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null},{name:"annotationBrush",optional:!1,type:null}],returns:null},{name:"disableBrushEvents",docblock:null,modifiers:[],params:[],returns:null},{name:"enableBrushEvents",docblock:null,modifiers:[],params:[],returns:null},{name:"getDefaultBrush",docblock:null,modifiers:[],params:[],returns:null},{name:"onAnnotationBrushStart",docblock:null,modifiers:[],params:[],returns:null},{name:"onAnnotationBrushBrushed",docblock:null,modifiers:[],params:[],returns:null},{name:"onAnnotationBrushEnd",docblock:null,modifiers:[],params:[{name:"{ selection }",optional:!1,type:null},{name:"annotationBrush",optional:!1,type:null}],returns:null},{name:"getAnnotationValues",docblock:null,modifiers:[],params:[],returns:null},{name:"getCurrentTransform",docblock:null,modifiers:[],params:[],returns:null},{name:"handleToolbarZoom",docblock:null,modifiers:[],params:[{name:"type",optional:!1,type:null},{name:"zoomValue",optional:!1,type:null}],returns:null},{name:"doZoom",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomIn",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomOut",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomTo",docblock:null,modifiers:[],params:[{name:"zoomValue",optional:!1,type:null}],returns:null},{name:"pan",docblock:null,modifiers:[],params:[{name:"xMultiplier",optional:!1,type:null}],returns:null},{name:"initChart",docblock:null,modifiers:[],params:[],returns:null},{name:"updateInteractionMode",docblock:null,modifiers:[],params:[{name:"interactionMode",optional:!0,type:null}],returns:null},{name:"isCurrentTaskValidForAnnotation",docblock:null,modifiers:[],params:[],returns:null},{name:"updateAnnotationBrushes",docblock:null,modifiers:[],params:[],returns:null},{name:"repositionBrush",docblock:null,modifiers:[],params:[{name:"brush",optional:!1,type:null},{name:"d3brush",optional:!1,type:null}],returns:null},{name:"updateDataPoints",docblock:null,modifiers:[],params:[{name:"shouldAnimate",optional:!0,type:null}],returns:null},{name:"updatePresentation",docblock:null,modifiers:[],params:[{name:"width",optional:!1,type:null},{name:"height",optional:!1,type:null}],returns:null},{name:"updateScales",docblock:null,modifiers:[],params:[{name:"transform",optional:!1,type:null}],returns:null},{name:"repositionAxes",docblock:null,modifiers:[],params:[{name:"width",optional:!1,type:null},{name:"height",optional:!1,type:null}],returns:null},{name:"repositionAxisLabels",docblock:null,modifiers:[],params:[{name:"width",optional:!1,type:null},{name:"height",optional:!1,type:null},{name:"chartStyle",optional:!1,type:null}],returns:null},{name:"resizeDataMask",docblock:null,modifiers:[],params:[{name:"width",optional:!1,type:null},{name:"height",optional:!1,type:null},{name:"margin",optional:!1,type:null}],returns:null}],displayName:"LightCurveViewer",props:{dataExtent:{description:"",type:{name:"shape",value:{x:{name:"arrayOf",value:{name:"number"},required:!1},y:{name:"arrayOf",value:{name:"number"},required:!1}}},required:!1},dataPoints:{description:"",type:{name:"arrayOf",value:{name:"arrayOf",value:{name:"number"}}},required:!1},minZoom:{description:"",type:{name:"number"},required:!1},maxZoom:{description:"",type:{name:"number"},required:!1},innerMargin:{description:"",type:{name:"number"},required:!1},outerMargin:{description:"",type:{name:"number"},required:!1},axisXLabel:{description:"",type:{name:"string"},required:!1},axisXOffsetX:{description:"",type:{name:"number"},required:!1},axisXOffsetY:{description:"",type:{name:"number"},required:!1},axisYLabel:{description:"",type:{name:"string"},required:!1},axisYOffsetX:{description:"",type:{name:"number"},required:!1},axisYOffsetY:{description:"",type:{name:"number"},required:!1},chartStyle:{description:"",type:{name:"shape",value:{color:{name:"string",required:!1},background:{name:"string",required:!1},dataPointSize:{name:"string",required:!1},fontFamily:{name:"string",required:!1},fontSize:{name:"string",required:!1}}},required:!1},id:{description:"",type:{name:"number"},required:!1},interactionMode:{description:"",type:{name:"enum",value:[{value:"'annotate'",computed:!1},{value:"'move'",computed:!1}]},required:!1},setOnZoom:{description:"",type:{name:"func"},required:!0},onKeyDown:{description:"",type:{name:"func"},required:!1}}}},"./src/components/Classifier/components/SubjectViewer/components/VariableStarViewer/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>VariableStarViewer_VariableStarViewerContainer});var async_states=__webpack_require__("../lib-async-states/src/async-states.js"),async_states_default=__webpack_require__.n(async_states),prop_types=__webpack_require__("../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("../../node_modules/react/index.js"),extent=__webpack_require__("../../node_modules/d3-array/src/extent.js"),i18n=__webpack_require__("./src/translations/i18n.js"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),Grid=__webpack_require__("../../node_modules/grommet/es6/components/Grid/Grid.js"),Box=__webpack_require__("../../node_modules/grommet/es6/components/Box/Box.js"),withParentSize=__webpack_require__("../../node_modules/@visx/responsive/esm/enhancers/withParentSize.js"),SpacedText=__webpack_require__("../lib-react-components/dist/esm/SpacedText/SpacedText.js"),ScatterPlotViewer=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/ScatterPlotViewer/index.js"),SingleImageViewer=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/SingleImageViewer/index.js"),BarChartViewer=__webpack_require__("./src/components/Classifier/components/SubjectViewer/components/BarChartViewer/index.js"),PlainButton=__webpack_require__("../lib-react-components/dist/esm/PlainButton/PlainButton.js"),withThemeContext=__webpack_require__("../lib-react-components/dist/esm/helpers/withThemeContext/withThemeContext.js"),Blank=__webpack_require__("../../node_modules/grommet-icons/es6/icons/Blank.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function FlipIcon(props){return(0,jsx_runtime.jsxs)(Blank.h,_objectSpread(_objectSpread({viewBox:"0 0 26 26"},props),{},{children:[(0,jsx_runtime.jsx)("circle",{cx:"13",cy:"13",r:"12",stroke:"currentColor",fill:"transparent"}),(0,jsx_runtime.jsxs)("g",{transform:"translate(6, 6)",children:[(0,jsx_runtime.jsx)("polygon",{points:"4.647375 8.27813672 4.647375 1.98481641 7.55198437 4.88942578 8.27813672 4.13906836 4.13906836 1.687539e-14 -3.99680289e-14 4.13906836 0.726152344 4.8652207 3.63076172 1.98481641 3.63076172 8.27813672",stroke:"currentColor",strokeWidth:"1"}),(0,jsx_runtime.jsx)("polygon",{points:"10.3355684 13.1763867 14.4746367 9.03731836 13.7484844 8.28696094 10.843875 11.1915703 10.843875 4.89825 9.82726172 4.89825 9.82726172 11.1915703 6.92265234 8.31116602 6.1965 9.03731836",stroke:"currentColor",strokeWidth:"1"})]})]}))}FlipIcon.displayName="FlipIcon",FlipIcon.__docgenInfo={description:"",methods:[],displayName:"FlipIcon"};const Controls_theme={checkBox:{border:{color:{light:"light-6",dark:"light-3"}},hover:{border:{color:{dark:"accent-1",light:"neutral-1"}}},gap:"0px",icon:{size:"20px"},size:"14px"},radioButton:{border:{color:{light:"light-6",dark:"light-3"}},hover:{border:{color:{dark:"accent-1",light:"neutral-1"}}},gap:"0px",size:"10px",icon:{size:"16px"}}};var CheckBox=__webpack_require__("../../node_modules/grommet/es6/components/CheckBox/CheckBox.js"),getDataSeriesColor=__webpack_require__("./src/components/Classifier/components/SubjectViewer/helpers/getDataSeriesColor/getDataSeriesColor.js"),getDataSeriesSymbol=__webpack_require__("./src/components/Classifier/components/SubjectViewer/helpers/getDataSeriesSymbol/index.js"),isDataSeriesHighlighted=__webpack_require__("./src/components/Classifier/components/SubjectViewer/helpers/isDataSeriesHighlighted/isDataSeriesHighlighted.js"),StyledLabel=styled_components_browser_esm.default.span.withConfig({displayName:"Label__StyledLabel",componentId:"sc-ds5x7v-0"})(["align-items:center;cursor:pointer;display:inline-flex;flex-direction:row;padding:2.5px;svg{padding:0px 0.5ch;}&:hover,&:focus-within{background-color:rgba(216,216,216,0.4);}"]);function Label(props){var colors=props.colors,label=props.label,seriesIndex=props.seriesIndex,_props$seriesOptions=props.seriesOptions,seriesOptions=void 0===_props$seriesOptions?{}:_props$seriesOptions,highlightedSeries=props.highlightedSeries,highlighted=(0,isDataSeriesHighlighted.A)({highlightedSeries,seriesOptions}),Glyph=(0,getDataSeriesSymbol.A)({seriesOptions,seriesIndex}),color=(0,getDataSeriesColor.A)({defaultColors:Object.values(colors.drawingTools),highlighted,seriesOptions,seriesIndex,themeColors:colors});return(0,jsx_runtime.jsxs)(StyledLabel,{children:[(0,jsx_runtime.jsx)("svg",{viewBox:"0 0 10 10",width:"15px",children:(0,jsx_runtime.jsx)(Glyph,{left:5,fill:color,size:20,stroke:highlighted?"black":colors["light-4"],top:5})}),(0,jsx_runtime.jsx)(SpacedText.A,{style:{whiteSpace:"nowrap"},size:"0.5em",weight:"bold",children:label})]})}Label.displayName="Label",Label.propTypes={colors:prop_types_default().object.isRequired,label:prop_types_default().string.isRequired,seriesIndex:prop_types_default().number.isRequired,seriesOptions:prop_types_default().object,highlighted:prop_types_default().bool};const Label_Label=Label;Label.__docgenInfo={description:"",methods:[],displayName:"Label",props:{colors:{description:"",type:{name:"object"},required:!0},label:{description:"",type:{name:"string"},required:!0},seriesIndex:{description:"",type:{name:"number"},required:!0},seriesOptions:{description:"",type:{name:"object"},required:!1},highlighted:{description:"",type:{name:"bool"},required:!1}}};var DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1};function HighlightSeriesCheckBoxes(props){var data=props.data,highlightedSeries=props.highlightedSeries,_props$setSeriesHighl=props.setSeriesHighlight,setSeriesHighlight=void 0===_props$setSeriesHighl?DEFAULT_HANDLER:_props$setSeriesHighl,_props$theme=props.theme,_props$theme2$global$=(void 0===_props$theme?{global:{colors:{drawingTools:{}}}}:_props$theme).global.colors,colors=void 0===_props$theme2$global$?{drawingTools:{}}:_props$theme2$global$;return(0,jsx_runtime.jsx)(Box.a,{direction:"column",pad:"none",children:data.map((function(series,seriesIndex){var seriesOptions=series.seriesOptions,label=seriesOptions.label,checked=(0,isDataSeriesHighlighted.A)({highlightedSeries,seriesOptions});return(0,jsx_runtime.jsx)(CheckBox.o,{checked,label:(0,jsx_runtime.jsx)(Label_Label,{colors,checked,label,seriesIndex,seriesOptions,highlightedSeries}),name:"series-highlight",onChange:function onChange(event){setSeriesHighlight(event)},type:"checkbox",value:label},"".concat(label,"-").concat(seriesIndex))}))})}HighlightSeriesCheckBoxes.displayName="HighlightSeriesCheckBoxes",HighlightSeriesCheckBoxes.propTypes={data:prop_types_default().arrayOf(prop_types_default().shape({seriesData:prop_types_default().array,seriesOptions:prop_types_default().object})).isRequired,highlightedSeries:prop_types_default().arrayOf(prop_types_default().string).isRequired,setSeriesHighlight:prop_types_default().func,theme:prop_types_default().object};const HighlightSeriesCheckBoxes_HighlightSeriesCheckBoxes=(0,styled_components_browser_esm.withTheme)(HighlightSeriesCheckBoxes);HighlightSeriesCheckBoxes.__docgenInfo={description:"",methods:[],displayName:"HighlightSeriesCheckBoxes",props:{data:{description:"",type:{name:"arrayOf",value:{name:"shape",value:{seriesData:{name:"array",required:!1},seriesOptions:{name:"object",required:!1}}}},required:!0},highlightedSeries:{description:"",type:{name:"arrayOf",value:{name:"string"}},required:!0},setSeriesHighlight:{description:"",type:{name:"func"},required:!1},theme:{description:"",type:{name:"object"},required:!1}}};var RadioButton=__webpack_require__("../../node_modules/grommet/es6/components/RadioButton/RadioButton.js"),PhaseFocusControls_DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1};function PhaseFocusControls(props){var data=props.data,highlightedSeries=props.highlightedSeries,phaseFocusedSeries=props.phaseFocusedSeries,_props$setSeriesPhase=props.setSeriesPhaseFocus,setSeriesPhaseFocus=void 0===_props$setSeriesPhase?PhaseFocusControls_DEFAULT_HANDLER:_props$setSeriesPhase,_props$theme=props.theme,_props$theme2$global$=(void 0===_props$theme?{global:{colors:{drawingTools:{}}}}:_props$theme).global.colors,colors=void 0===_props$theme2$global$?{drawingTools:{}}:_props$theme2$global$,t=(0,i18n.Bd)("components").t;return(0,jsx_runtime.jsx)(Box.a,{direction:"column",pad:"none",children:data.map((function(series,seriesIndex){var seriesOptions=series.seriesOptions,checked=phaseFocusedSeries===seriesIndex,label=(null==seriesOptions?void 0:seriesOptions.label)||t("SubjectViewer.VariableStarViewer.label",{id:seriesIndex+1});return(0,jsx_runtime.jsx)(RadioButton.a,{checked,label:(0,jsx_runtime.jsx)(Label_Label,{colors,highlightedSeries,seriesIndex,seriesOptions,label,visible:!0}),name:"series-phase-focus",onChange:function onChange(event){setSeriesPhaseFocus(event)},type:"radio",value:seriesIndex.toString()},"".concat(label,"-").concat(seriesIndex))}))})}PhaseFocusControls.displayName="PhaseFocusControls",PhaseFocusControls.propTypes={data:prop_types_default().arrayOf(prop_types_default().shape({seriesData:prop_types_default().array,seriesOptions:prop_types_default().object})).isRequired,phaseFocusedSeries:prop_types_default().number.isRequired,setSeriesPhaseFocus:prop_types_default().func,theme:prop_types_default().object};const PhaseFocusControls_PhaseFocusControls=(0,styled_components_browser_esm.withTheme)(PhaseFocusControls);PhaseFocusControls.__docgenInfo={description:"",methods:[],displayName:"PhaseFocusControls",props:{data:{description:"",type:{name:"arrayOf",value:{name:"shape",value:{seriesData:{name:"array",required:!1},seriesOptions:{name:"object",required:!1}}}},required:!0},phaseFocusedSeries:{description:"",type:{name:"number"},required:!0},setSeriesPhaseFocus:{description:"",type:{name:"func"},required:!1},theme:{description:"",type:{name:"object"},required:!1}}};var RadioButtonGroup=__webpack_require__("../../node_modules/grommet/es6/components/RadioButtonGroup/RadioButtonGroup.js"),FormField=__webpack_require__("../../node_modules/grommet/es6/components/FormField/FormField.js");const PeriodMultipleControls_theme={checkBox:{icon:{size:"20px"},size:"14px"},formField:{border:"none",extend:function extend(){return(0,styled_components_browser_esm.css)(["flex-direction:column-reverse;"])},label:{margin:"none"},margin:"none"},radioButton:{border:{color:{light:"light-6",dark:"light-3"}},extend:function extend(){return(0,styled_components_browser_esm.css)(["position:relative;input:not(:checked) + div{height:5px;margin-bottom:5px;position:relative;top:2.5px;width:5px;}"])},hover:{border:{color:{dark:"accent-1",light:"neutral-1"}}},gap:"0px",size:"10px",icon:{size:"6px"}}};var StyledRadioButtonGroup=(0,styled_components_browser_esm.default)(RadioButtonGroup.z).withConfig({displayName:"PeriodMultipleControls__StyledRadioButtonGroup",componentId:"sc-6f8fqo-0"})(["label{flex-direction:column;}> div{position:relative;}> div:after{"," bottom:0;content:'';height:5px;left:1px;position:absolute;right:0;top:0;width:28px;}"],(function(props){return(0,styled_components_browser_esm.css)(["border-bottom:1px solid ",";"],props.color)}));function PeriodMultipleControls(props){var periodMultiple=props.periodMultiple,options=props.options,setPeriodMultiple=props.setPeriodMultiple,_props$theme=props.theme,theme=void 0===_props$theme?{global:{colors:{}}}:_props$theme,t=(0,i18n.Bd)("components").t;return(0,jsx_runtime.jsx)(FormField.z,{htmlFor:"periodMultiple",label:(0,jsx_runtime.jsx)(SpacedText.A,{size:"10px",weight:"bold",children:t("SubjectViewer.VariableStarViewer.periodMultiple")}),children:(0,jsx_runtime.jsx)(StyledRadioButtonGroup,{color:theme.global.colors["light-6"],direction:"row",gap:"medium",id:"periodMultiple",name:"periodMultiple",onChange:function onChange(event){return setPeriodMultiple(event)},options,value:periodMultiple.toString()})})}PeriodMultipleControls.displayName="PeriodMultipleControls",PeriodMultipleControls.propTypes={options:prop_types_default().array.isRequired,periodMultiple:prop_types_default().number.isRequired,setPeriodMultiple:prop_types_default().func.isRequired,theme:prop_types_default().object};const PeriodMultipleControls_PeriodMultipleControls=(0,withThemeContext.A)(PeriodMultipleControls,PeriodMultipleControls_theme);PeriodMultipleControls.__docgenInfo={description:"",methods:[],displayName:"PeriodMultipleControls",props:{options:{description:"",type:{name:"array"},required:!0},periodMultiple:{description:"",type:{name:"number"},required:!0},setPeriodMultiple:{description:"",type:{name:"func"},required:!0},theme:{description:"",type:{name:"object"},required:!1}}};var FlipButton=(0,styled_components_browser_esm.default)(PlainButton.Ay).withConfig({displayName:"Controls__FlipButton",componentId:"sc-m20jhr-0"})(["&:enabled:hover,&:focus{text-decoration:none;> div > svg > circle{fill:rgba(216,216,216,0.4);}}> div{flex-direction:column;}"]),Controls_DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1};function Controls(props){var _props$data=props.data,data=void 0===_props$data?[]:_props$data,_props$gridArea=props.gridArea,gridArea=void 0===_props$gridArea?"":_props$gridArea,_props$highlightedSer=props.highlightedSeries,highlightedSeries=void 0===_props$highlightedSer?[]:_props$highlightedSer,_props$periodMultiple=props.periodMultiple,periodMultiple=void 0===_props$periodMultiple?1:_props$periodMultiple,_props$periodMultiple2=props.periodMultipleOptions,periodMultipleOptions=void 0===_props$periodMultiple2?["0.5","1","2","3"]:_props$periodMultiple2,_props$phaseFocusedSe=props.phaseFocusedSeries,phaseFocusedSeries=void 0===_props$phaseFocusedSe?0:_props$phaseFocusedSe,_props$setSeriesHighl=props.setSeriesHighlight,setSeriesHighlight=void 0===_props$setSeriesHighl?Controls_DEFAULT_HANDLER:_props$setSeriesHighl,setSeriesPhaseFocus=props.setSeriesPhaseFocus,_props$setPeriodMulti=props.setPeriodMultiple,setPeriodMultiple=void 0===_props$setPeriodMulti?Controls_DEFAULT_HANDLER:_props$setPeriodMulti,_props$setYAxisInvers=props.setYAxisInversion,setYAxisInversion=void 0===_props$setYAxisInvers?Controls_DEFAULT_HANDLER:_props$setYAxisInvers,t=(0,i18n.Bd)("components").t,radioButtonOptions=periodMultipleOptions.map((function(option){return{label:(0,jsx_runtime.jsx)(SpacedText.A,{size:"10px",style:{width:"1ch"},weight:"bold",children:option}),value:option}}));return(0,jsx_runtime.jsxs)(Box.a,{background:{dark:"dark-3",light:"neutral-6"},border:{color:{light:"light-3",dark:"dark-3"},size:"xsmall"},direction:"row",justify:"between",gridArea,pad:"xsmall",children:[(0,jsx_runtime.jsx)(SpacedText.A,{style:{fontSize:"0.5em",textAlign:"center",transform:"rotate(180deg)",writingMode:"vertical-lr"},children:t("SubjectViewer.VariableStarViewer.controls")}),(0,jsx_runtime.jsx)(FlipButton,{icon:(0,jsx_runtime.jsx)(FlipIcon,{}),label:(0,jsx_runtime.jsx)(SpacedText.A,{margin:{top:"5px"},size:"10px",weight:"bold",children:t("SubjectViewer.VariableStarViewer.flip")}),onClick:function onClick(event){return setYAxisInversion(event)},pad:"small"}),(0,jsx_runtime.jsx)(PeriodMultipleControls_PeriodMultipleControls,{options:radioButtonOptions,periodMultiple,setPeriodMultiple}),(0,jsx_runtime.jsxs)(Box.a,{justify:"between",children:[(0,jsx_runtime.jsx)(PhaseFocusControls_PhaseFocusControls,{data,highlightedSeries,phaseFocusedSeries,setSeriesPhaseFocus}),(0,jsx_runtime.jsx)(SpacedText.A,{size:"10px",weight:"bold",children:t("SubjectViewer.VariableStarViewer.phaseFocus")})]}),(0,jsx_runtime.jsxs)(Box.a,{justify:"between",children:[(0,jsx_runtime.jsx)(HighlightSeriesCheckBoxes_HighlightSeriesCheckBoxes,{data,highlightedSeries,setSeriesHighlight}),(0,jsx_runtime.jsx)(SpacedText.A,{size:"10px",weight:"bold",children:t("SubjectViewer.VariableStarViewer.highlight")})]})]})}Controls.displayName="Controls",Controls.propTypes={data:prop_types_default().array,gridArea:prop_types_default().string,highlightedSeries:prop_types_default().arrayOf(prop_types_default().object),periodMultiple:prop_types_default().number,periodMultipleOptions:prop_types_default().arrayOf(prop_types_default().string),phaseFocusedSeries:prop_types_default().number,setSeriesHighlight:prop_types_default().func,setPeriodMultiple:prop_types_default().func,setYAxisInversion:prop_types_default().func};const Controls_Controls=(0,withThemeContext.A)(Controls,Controls_theme);Controls.__docgenInfo={description:"",methods:[],displayName:"Controls",props:{data:{description:"",type:{name:"array"},required:!1},gridArea:{description:"",type:{name:"string"},required:!1},highlightedSeries:{description:"",type:{name:"arrayOf",value:{name:"object"}},required:!1},periodMultiple:{description:"",type:{name:"number"},required:!1},periodMultipleOptions:{description:"",type:{name:"arrayOf",value:{name:"string"}},required:!1},phaseFocusedSeries:{description:"",type:{name:"number"},required:!1},setSeriesHighlight:{description:"",type:{name:"func"},required:!1},setPeriodMultiple:{description:"",type:{name:"func"},required:!1},setYAxisInversion:{description:"",type:{name:"func"},required:!1}}};var VariableStarViewer_DEFAULT_HANDLER=function DEFAULT_HANDLER(){return!1},VariableStarViewer=(0,react.forwardRef)((function(props,ref){var _rawJSON$data,_props$allowPanZoom=props.allowPanZoom,allowPanZoom=void 0===_props$allowPanZoom?"":_props$allowPanZoom,_props$barJSON=props.barJSON,barJSON=void 0===_props$barJSON?{amplitude:{data:[],chartOptions:{}},period:{data:[],chartOptions:{}}}:_props$barJSON,_props$highlightedSer=props.highlightedSeries,highlightedSeries=void 0===_props$highlightedSer?[]:_props$highlightedSer,_props$imageLocation=props.imageLocation,imageLocation=void 0===_props$imageLocation?null:_props$imageLocation,_props$invertYAxis=props.invertYAxis,invertYAxis=void 0!==_props$invertYAxis&&_props$invertYAxis,loadingState=props.loadingState,parentWidth=(props.parentHeight,props.parentWidth),_props$periodMultiple=props.periodMultiple,periodMultiple=void 0===_props$periodMultiple?1:_props$periodMultiple,_props$phaseFocusedSe=props.phaseFocusedSeries,phaseFocusedSeries=void 0===_props$phaseFocusedSe?0:_props$phaseFocusedSe,_props$phasedJSON=props.phasedJSON,phasedJSON=void 0===_props$phasedJSON?{data:[],chartOptions:{}}:_props$phasedJSON,phaseLimit=props.phaseLimit,_props$rawJSON=props.rawJSON,rawJSON=void 0===_props$rawJSON?{data:{scatterPlot:{data:[],chartOptions:{}},barCharts:{}}}:_props$rawJSON,setAllowPanZoom=props.setAllowPanZoom,_props$setOnPan=props.setOnPan,setOnPan=void 0===_props$setOnPan?function(){return!0}:_props$setOnPan,_props$setOnZoom=props.setOnZoom,setOnZoom=void 0===_props$setOnZoom?function(){return!0}:_props$setOnZoom,_props$setPeriodMulti=props.setPeriodMultiple,setPeriodMultiple=void 0===_props$setPeriodMulti?VariableStarViewer_DEFAULT_HANDLER:_props$setPeriodMulti,_props$setSeriesPhase=props.setSeriesPhaseFocus,setSeriesPhaseFocus=void 0===_props$setSeriesPhase?VariableStarViewer_DEFAULT_HANDLER:_props$setSeriesPhase,_props$setSeriesHighl=props.setSeriesHighlight,setSeriesHighlight=void 0===_props$setSeriesHighl?VariableStarViewer_DEFAULT_HANDLER:_props$setSeriesHighl,_props$setYAxisInvers=props.setYAxisInversion,setYAxisInversion=void 0===_props$setYAxisInvers?VariableStarViewer_DEFAULT_HANDLER:_props$setYAxisInvers,_props$theme=props.theme,theme=void 0===_props$theme?{dark:!1,global:{colors:{},font:{}}}:_props$theme,scatterPlot=(null==rawJSON?void 0:rawJSON.scatterPlot)||(null==rawJSON||null===(_rawJSON$data=rawJSON.data)||void 0===_rawJSON$data?void 0:_rawJSON$data.scatterPlot),t=(0,i18n.Bd)("components").t,underlays=[{fill:theme.dark?theme.global.colors["light-5"]:theme.global.colors["light-3"],startPosition:-phaseLimit,xAxisWidth:phaseLimit},{fill:theme.dark?theme.global.colors["light-5"]:theme.global.colors["light-3"],startPosition:1,xAxisWidth:phaseLimit}],zoomEnabled={HRDiagram:"HRDiagram"===allowPanZoom,phasedJSON:"phasedJSON"===allowPanZoom,rawJSON:"rawJSON"===allowPanZoom},areas=parentWidth<=768?[{name:"controls",start:[0,0],end:[0,0]},{name:"scatterPlots",start:[0,1],end:[0,1]},{name:"barCharts",start:[0,2],end:[0,2]},{name:"HRDiagram",start:[0,3],end:[0,3]}]:[{name:"controls",start:[0,0],end:[0,0]},{name:"scatterPlots",start:[0,1],end:[0,7]},{name:"barCharts",start:[1,0],end:[1,2]},{name:"HRDiagram",start:[1,3],end:[1,7]}],columns=parentWidth<=768?["full"]:["2/3","1/3"],rows=parentWidth<=768?["80px","590px","330px","620px"]:["80px","80px","80px","80px","80px","80px","80px","50px"];return(0,jsx_runtime.jsxs)(Grid.x,{areas,columns,fill:!0,gap:"xsmall",pad:{horizontal:"xsmall"},ref,rows,children:[(0,jsx_runtime.jsx)(Controls_Controls,{data:null==scatterPlot?void 0:scatterPlot.data,gridArea:"controls",highlightedSeries,periodMultiple,phaseFocusedSeries,setPeriodMultiple,setSeriesPhaseFocus,setSeriesHighlight,setYAxisInversion,theme}),(0,jsx_runtime.jsx)(Box.a,{border:{color:{light:"light-3",dark:"dark-3"},size:"xsmall"},fill:!0,gridArea:"scatterPlots",children:(0,jsx_runtime.jsxs)(Grid.x,{areas:[{name:"phasedJSON",start:[0,0],end:[0,0]},{name:"rawJSON",start:[0,1],end:[0,1]}],columns:["auto"],fill:!0,gap:"5px",rows:["2/3","1/3"],children:[(0,jsx_runtime.jsx)(Box.a,{border:zoomEnabled.phasedJSON&&{color:"brand",size:"xsmall"},gridArea:"phasedJSON",style:{position:"relative"},children:(0,jsx_runtime.jsx)(ScatterPlotViewer.A,{data:phasedJSON.data,highlightedSeries,invertAxes:{x:!1,y:invertYAxis},margin:{bottom:50,left:60,right:10,top:30},setOnPan,setOnZoom,underlays,xAxisLabel:t("SubjectViewer.VariableStarViewer.phase"),xAxisNumTicks:8,yAxisLabel:phasedJSON.chartOptions.yAxisLabel,yAxisNumTicks:8,zoomControlFn:zoomEnabled.phasedJSON?function(){return setAllowPanZoom("")}:function(){return setAllowPanZoom("phasedJSON")},zooming:zoomEnabled.phasedJSON})}),(0,jsx_runtime.jsx)(Box.a,{border:zoomEnabled.rawJSON&&{color:"brand",size:"xsmall"},gridArea:"rawJSON",style:{position:"relative"},children:(0,jsx_runtime.jsx)(ScatterPlotViewer.A,{data:null==scatterPlot?void 0:scatterPlot.data,highlightedSeries,invertAxes:{x:!1,y:invertYAxis},margin:{bottom:50,left:60,right:10,top:30},setOnPan,setOnZoom,xAxisLabel:null==scatterPlot?void 0:scatterPlot.chartOptions.xAxisLabel,xAxisNumTicks:4,yAxisLabel:null==scatterPlot?void 0:scatterPlot.chartOptions.yAxisLabel,yAxisNumTicks:6,zoomControlFn:zoomEnabled.rawJSON?function(){return setAllowPanZoom("")}:function(){return setAllowPanZoom("rawJSON")},zooming:zoomEnabled.rawJSON})})]})}),(0,jsx_runtime.jsx)(Box.a,{background:{dark:"dark-3",light:"neutral-6"},border:{color:{light:"light-3",dark:"dark-3"},size:"xsmall"},direction:"row",gridArea:"barCharts",margin:{bottom:"xsmall"},pad:"none",children:Object.keys(barJSON).map((function(barChartKey){return(0,jsx_runtime.jsx)(Box.a,{basis:"1/2",children:(0,jsx_runtime.jsx)(BarChartViewer.A,{data:barJSON[barChartKey].data,xAxisLabel:barJSON[barChartKey].chartOptions.xAxisLabel,yAxisDomain:barJSON[barChartKey].chartOptions.yAxisDomain,yAxisLabel:barJSON[barChartKey].chartOptions.yAxisLabel})},barChartKey)}))}),imageLocation&&(0,jsx_runtime.jsxs)(Box.a,{as:"figure",direction:"column",gridArea:"HRDiagram",margin:"none",children:[(0,jsx_runtime.jsx)(SingleImageViewer.tv,{"aria-labelledby":"imageId",enableInteractionLayer:!1,loadingState,role:"img",subject:{locations:[imageLocation]},title:{id:"imageId",text:t("SubjectViewer.VariableStarViewer.imageTitle")}}),(0,jsx_runtime.jsx)("figcaption",{children:(0,jsx_runtime.jsx)(SpacedText.A,{color:{light:"dark-5",dark:"light-1"},weight:"bold",children:t("SubjectViewer.VariableStarViewer.figCaption")})})]})]})}));VariableStarViewer.propTypes={allowPanZoom:prop_types_default().string,barJSON:prop_types_default().shape({amplitude:prop_types_default().shape({data:prop_types_default().array,options:prop_types_default().object}),period:prop_types_default().shape({data:prop_types_default().array,options:prop_types_default().object})}),highlightedSeries:prop_types_default().arrayOf(prop_types_default().object),imageLocation:prop_types_default().object,invertYAxis:prop_types_default().bool,parentHeight:prop_types_default().number,parentWidth:prop_types_default().number,periodMultiple:prop_types_default().number,phaseFocusedSeries:prop_types_default().number,phasedJSON:prop_types_default().shape({data:prop_types_default().array,chartOptions:prop_types_default().object}),rawJSON:prop_types_default().shape({data:prop_types_default().object,chartOptions:prop_types_default().object}),setOnPan:prop_types_default().func,setOnZoom:prop_types_default().func,setPeriodMultiple:prop_types_default().func,setSeriesPhaseFocus:prop_types_default().func,setSeriesHighlight:prop_types_default().func,setYAxisInversion:prop_types_default().func,theme:prop_types_default().object,zooming:prop_types_default().bool};const VariableStarViewer_VariableStarViewer=(0,styled_components_browser_esm.withTheme)((0,withParentSize.A)(VariableStarViewer));VariableStarViewer.__docgenInfo={description:"",methods:[],displayName:"VariableStarViewer",props:{allowPanZoom:{description:"",type:{name:"string"},required:!1},barJSON:{description:"",type:{name:"shape",value:{amplitude:{name:"shape",value:{data:{name:"array",required:!1},options:{name:"object",required:!1}},required:!1},period:{name:"shape",value:{data:{name:"array",required:!1},options:{name:"object",required:!1}},required:!1}}},required:!1},highlightedSeries:{description:"",type:{name:"arrayOf",value:{name:"object"}},required:!1},imageLocation:{description:"",type:{name:"object"},required:!1},invertYAxis:{description:"",type:{name:"bool"},required:!1},parentHeight:{description:"",type:{name:"number"},required:!1},parentWidth:{description:"",type:{name:"number"},required:!1},periodMultiple:{description:"",type:{name:"number"},required:!1},phaseFocusedSeries:{description:"",type:{name:"number"},required:!1},phasedJSON:{description:"",type:{name:"shape",value:{data:{name:"array",required:!1},chartOptions:{name:"object",required:!1}}},required:!1},rawJSON:{description:"",type:{name:"shape",value:{data:{name:"object",required:!1},chartOptions:{name:"object",required:!1}}},required:!1},setOnPan:{description:"",type:{name:"func"},required:!1},setOnZoom:{description:"",type:{name:"func"},required:!1},setPeriodMultiple:{description:"",type:{name:"func"},required:!1},setSeriesPhaseFocus:{description:"",type:{name:"func"},required:!1},setSeriesHighlight:{description:"",type:{name:"func"},required:!1},setYAxisInversion:{description:"",type:{name:"func"},required:!1},theme:{description:"",type:{name:"object"},required:!1},zooming:{description:"",type:{name:"bool"},required:!1}}};var additiveDictionary={.5:-.301,1:0,2:.301,3:.477},locationValidator=__webpack_require__("./src/components/Classifier/components/SubjectViewer/helpers/locationValidator/index.js");function VariableStarViewerContainer_typeof(o){return VariableStarViewerContainer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},VariableStarViewerContainer_typeof(o)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function define(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==VariableStarViewerContainer_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(VariableStarViewerContainer_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)}))}}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,VariableStarViewerContainer_toPropertyKey(o.key),o)}}function VariableStarViewerContainer_toPropertyKey(t){var i=function VariableStarViewerContainer_toPrimitive(t,r){if("object"!=VariableStarViewerContainer_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=VariableStarViewerContainer_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==VariableStarViewerContainer_typeof(i)?i:i+""}function _callSuper(t,o,e){return o=_getPrototypeOf(o),function _possibleConstructorReturn(t,e){if(e&&("object"==VariableStarViewerContainer_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(t,_isNativeReflectConstruct()?Reflect.construct(o,e||[],_getPrototypeOf(t).constructor):o.apply(t,e))}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}var VariableStarViewerContainer=function(_Component){function VariableStarViewerContainer(){var _this;return function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}(this,VariableStarViewerContainer),(_this=_callSuper(this,VariableStarViewerContainer)).viewer=(0,react.createRef)(),_this.state={allowPanZoom:"",barJSON:{amplitude:{data:[],chartOptions:{}},period:{data:[],chartOptions:{}}},highlightedSeries:[],imageLocation:null,invertYAxis:!1,periodMultiple:1,phaseFocusedSeries:0,phasedJSON:{data:[],chartOptions:{}},phaseLimit:.2,rawJSON:{scatterPlot:{data:[],chartOptions:{}},barCharts:{amplitude:{data:[],chartOptions:{}},period:{data:[],chartOptions:{}}}}},_this.setAllowPanZoom=_this.setAllowPanZoom.bind(_this),_this.setPeriodMultiple=_this.setPeriodMultiple.bind(_this),_this.setSeriesPhaseFocus=_this.setSeriesPhaseFocus.bind(_this),_this.setSeriesHighlight=_this.setSeriesHighlight.bind(_this),_this.setYAxisInversion=_this.setYAxisInversion.bind(_this),_this}return function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}(VariableStarViewerContainer,_Component),function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(VariableStarViewerContainer,[{key:"componentDidMount",value:(_componentDidMount=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var data;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(data=this.props.data)){_context.next=4;break}return _context.next=4,this.onLoad(data);case 4:case"end":return _context.stop()}}),_callee,this)}))),function componentDidMount(){return _componentDidMount.apply(this,arguments)})},{key:"componentDidUpdate",value:(_componentDidUpdate=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(prevProps){var data,prevData;return _regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(data=this.props.data,prevData=prevProps.data,data===prevData){_context2.next=6;break}return _context2.next=6,this.onLoad(data);case 6:case"end":return _context2.stop()}}),_callee2,this)}))),function componentDidUpdate(_x){return _componentDidUpdate.apply(this,arguments)})},{key:"onLoad",value:function onLoad(data){var _this$viewer$current,scatterPlot=data.scatterPlot,barCharts=data.barCharts,_this$props=this.props,onReady=_this$props.onReady,subject=_this$props.subject,container=null===(_this$viewer$current=this.viewer.current)||void 0===_this$viewer$current?void 0:_this$viewer$current.container,phasedJSON=this.calculatePhase(scatterPlot),barJSON=this.calculateBarJSON(barCharts),highlightedSeries=this.setupSeriesHighlight(scatterPlot),imageLocation=subject.locations[2]||{},_ref=container?container.getBoundingClientRect():{},target={clientWidth:_ref.width,clientHeight:_ref.height,naturalWidth:0,naturalHeight:0};this.setState({barJSON,imageLocation,phasedJSON,rawJSON:data,highlightedSeries},(function(){onReady({target})}))}},{key:"calculatePhase",value:function calculatePhase(scatterPlotJSON){var seriesIndexForPeriod=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.phaseFocusedSeries,_this$state=this.state,periodMultiple=_this$state.periodMultiple,phaseLimit=_this$state.phaseLimit,phasedJSON={data:[],chartOptions:scatterPlotJSON.chartOptions};return scatterPlotJSON.data.forEach((function(series,seriesIndex){var seriesPeriod=parseFloat(scatterPlotJSON.data[seriesIndexForPeriod].seriesOptions.period)*periodMultiple,seriesData=[];series.seriesData.forEach((function(datum){var phasedXPoint,calculatedXPoint=datum.x%seriesPeriod/seriesPeriod;seriesData.push(Object.assign({},datum,{x:calculatedXPoint,mirrored:!1})),calculatedXPoint<phaseLimit?phasedXPoint=calculatedXPoint+1:calculatedXPoint>1-phaseLimit&&(phasedXPoint=calculatedXPoint-1),phasedXPoint&&seriesData.push(Object.assign({},datum,{x:phasedXPoint,mirrored:!0}))})),phasedJSON.data.push({seriesData,seriesOptions:series.seriesOptions})})),phasedJSON}},{key:"calculateBarJSON",value:function calculateBarJSON(barChartJSON){var periodMultiple=this.state.periodMultiple,phasedBarChartJSON={amplitude:barChartJSON.amplitude,period:{data:[],chartOptions:barChartJSON.period.chartOptions}},chartOptions=phasedBarChartJSON.period.chartOptions;if(barChartJSON.period.data.forEach((function(datum){var phasedDatum=Object.assign({},datum,{value:datum.value+additiveDictionary[periodMultiple.toString()]});phasedBarChartJSON.period.data.push(phasedDatum)})),!chartOptions.yAxisDomain){var yDataExtent=(0,extent.A)(phasedBarChartJSON.period.data.map((function(datum){return datum.value}))),yAxisDomain=[Math.floor(yDataExtent[0]),Math.ceil(yDataExtent[1])+1];phasedBarChartJSON.period.chartOptions=Object.assign({},chartOptions,{yAxisDomain})}return phasedBarChartJSON}},{key:"calculateJSON",value:function calculateJSON(){var _this$state$rawJSON=this.state.rawJSON,scatterPlot=_this$state$rawJSON.scatterPlot,barCharts=_this$state$rawJSON.barCharts,phasedJSON=this.calculatePhase(scatterPlot),barJSON=this.calculateBarJSON(barCharts);this.setState({barJSON,phasedJSON})}},{key:"setupSeriesHighlight",value:function setupSeriesHighlight(scatterPlotJSON){var t=this.props.t;return scatterPlotJSON.data.map((function(series,index){if((null==series?void 0:series.seriesData.length)>0){var _series$seriesOptions,_series$seriesOptions2,fallbackLabel=t("SubjectViewer.VariableStarViewer.label",{id:index+1});return null!==(_series$seriesOptions2=(_series$seriesOptions=series.seriesOptions).label)&&void 0!==_series$seriesOptions2||(_series$seriesOptions.label=fallbackLabel),series.seriesOptions.label}}))}},{key:"setAllowPanZoom",value:function setAllowPanZoom(area){this.setState({allowPanZoom:area})}},{key:"setPeriodMultiple",value:function setPeriodMultiple(event){var _this2=this,periodMultiple=parseFloat(event.target.value);this.setState({periodMultiple},(function(){return _this2.calculateJSON()}))}},{key:"setSeriesHighlight",value:function setSeriesHighlight(event){var newHighlightedSeriesState=this.state.highlightedSeries,seriesToUnhighlightIndex=this.state.highlightedSeries.findIndex((function(highlightedLabel){return highlightedLabel===event.target.value}));seriesToUnhighlightIndex>-1?newHighlightedSeriesState.splice(seriesToUnhighlightIndex,1):newHighlightedSeriesState.push(event.target.value),this.setState({highlightedSeries:newHighlightedSeriesState})}},{key:"setSeriesPhaseFocus",value:function setSeriesPhaseFocus(event){var seriesIndexForPeriod=parseInt(event.target.value),phasedJSON=this.calculatePhase(this.state.rawJSON.scatterPlot,seriesIndexForPeriod);this.setState({phasedJSON,phaseFocusedSeries:seriesIndexForPeriod})}},{key:"setYAxisInversion",value:function setYAxisInversion(){this.setState((function(prevState){return{invertYAxis:!prevState.invertYAxis}}))}},{key:"render",value:function render(){var _this$props2=this.props,loadingState=_this$props2.loadingState,setOnPan=_this$props2.setOnPan,setOnZoom=_this$props2.setOnZoom;return _this$props2.subject.id?(0,jsx_runtime.jsx)(VariableStarViewer_VariableStarViewer,{allowPanZoom:this.state.allowPanZoom,barJSON:this.state.barJSON,highlightedSeries:this.state.highlightedSeries,imageLocation:this.state.imageLocation,invertYAxis:this.state.invertYAxis,loadingState,periodMultiple:this.state.periodMultiple,phaseFocusedSeries:this.state.phaseFocusedSeries,phaseLimit:this.state.phaseLimit,phasedJSON:this.state.phasedJSON,rawJSON:this.state.rawJSON,ref:this.viewer,setOnPan,setOnZoom,setAllowPanZoom:this.setAllowPanZoom,setPeriodMultiple:this.setPeriodMultiple,setSeriesPhaseFocus:this.setSeriesPhaseFocus,setSeriesHighlight:this.setSeriesHighlight,setYAxisInversion:this.setYAxisInversion}):null}}]);var _componentDidUpdate,_componentDidMount}(react.Component);VariableStarViewerContainer.displayName="VariableStarViewerContainer",VariableStarViewerContainer.defaultProps={loadingState:async_states_default().initialized,onError:function onError(){return!0},onReady:function onReady(){return!0},setOnPan:function setOnPan(){},setOnZoom:function setOnZoom(){},subject:{id:"",locations:[]},t:function t(key){return key}},VariableStarViewerContainer.propTypes={loadingState:prop_types_default().string,onError:prop_types_default().func,onReady:prop_types_default().func,setOnPan:prop_types_default().func,setOnZoom:prop_types_default().func,subject:prop_types_default().shape({id:prop_types_default().string,locations:prop_types_default().arrayOf(locationValidator.A)})};const VariableStarViewer_VariableStarViewerContainer=(0,i18n.CI)("components")(VariableStarViewerContainer);VariableStarViewerContainer.__docgenInfo={description:"",methods:[{name:"onLoad",docblock:null,modifiers:[],params:[{name:"data",optional:!1,type:null}],returns:null},{name:"calculatePhase",docblock:null,modifiers:[],params:[{name:"scatterPlotJSON",optional:!1,type:null},{name:"seriesIndexForPeriod",optional:!0,type:null}],returns:null},{name:"calculateBarJSON",docblock:null,modifiers:[],params:[{name:"barChartJSON",optional:!1,type:null}],returns:null},{name:"calculateJSON",docblock:null,modifiers:[],params:[],returns:null},{name:"setupSeriesHighlight",docblock:null,modifiers:[],params:[{name:"scatterPlotJSON",optional:!1,type:null}],returns:null},{name:"setAllowPanZoom",docblock:null,modifiers:[],params:[{name:"area",optional:!1,type:null}],returns:null},{name:"setPeriodMultiple",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"setSeriesHighlight",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"setSeriesPhaseFocus",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"setYAxisInversion",docblock:null,modifiers:[],params:[],returns:null}],displayName:"VariableStarViewerContainer",props:{loadingState:{defaultValue:{value:"asyncStates.initialized",computed:!0},description:"",type:{name:"string"},required:!1},onError:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},onReady:{defaultValue:{value:"() => true",computed:!1},description:"",type:{name:"func"},required:!1},setOnPan:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},setOnZoom:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},subject:{defaultValue:{value:"{\n  id: '',\n  locations: []\n}",computed:!1},description:"",type:{name:"shape",value:{id:{name:"string",required:!1},locations:{name:"arrayOf",value:{name:"custom",raw:"locationValidator"},required:!1}}},required:!1},t:{defaultValue:{value:"(key) => key",computed:!1},required:!1}}}}}]);